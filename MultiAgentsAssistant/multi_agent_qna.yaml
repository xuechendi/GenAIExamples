opea_micro_services:
  ui:
    host: ${UI_SERVICE_HOST_IP}
    ports:
      - "5173:5173"
    image: opea/chatqna-ui:latest
    environment:
      - CHAT_BASE_URL=${BACKEND_SERVICE_ENDPOINT}
      - UPLOAD_FILE_BASE_URL=${DATAPREP_SERVICE_ENDPOINT}
  
  llm:
    host: ${LLM_SERVICE_HOST_IP}
    ports: ${LLM_SERVICE_PORT}
    image: opea/llm-tgi:latest
    endpoint: /v1/chat/completions
  
  embedding:
    host: ${EMBEDDING_SERVICE_HOST_IP}
    ports: ${EMBEDDING_SERVICE_PORT}
    image: opea/embedding-tei:latest
    endpoint: /v1/embeddings
  
  retrieval:
    host: ${RETRIEVER_SERVICE_HOST_IP}
    ports: ${RETRIEVER_SERVICE_PORT}
    image: opea/retriever-redis:latest
    endpoint: /v1/retrieval
  
  reranking:
    host: ${RERANK_SERVICE_HOST_IP}
    ports: ${RERANK_SERVICE_PORT}
    image: opea/reranking-tei:latest
    endpoint: /v1/reranking
  
  supervisor_agent:
    host: ${SUPERVISOR_AGENT_HOST_IP}
    ports: ${SUPERVISOR_AGENT_PORT}
    image: opea/supervisor-agent:latest
    endpoint: /v1/supervisor
    env_file: configs/supervisor_agent.env
  
  research_agent:
    host: ${RESEARCH_AGENT_HOST_IP}
    ports: ${RESEARCH_AGENT_PORT}
    image: opea/research-agent:latest
    endpoint: /v1/research
    env_file: configs/research_agent.env
  
  writer_agent:
    host: ${WRITER_AGENT_HOST_IP}
    ports: ${WRITER_AGENT_PORT}
    image: opea/writer-agent:latest
    endpoint: /v1/writer
    env_file: configs/writer_agent.env

opea_mega_service:
  retrieval_tool:
    host: ${RETRIEVER_SERVICE_HOST_IP}
    ports: ${RETRIEVER_SERVICE_PORT}
    image: opea/retriever-redis:latest
    endpoint: /v1/retrieval
    mega_flow:
      - embedding >> retrieval >> reranking
  
  business_insight_assistant:
    host: ${SUPERVISOR_AGENT_HOST_IP}
    ports: ${SUPERVISOR_AGENT_PORT}
    image: opea/supervisor-agent:latest
    endpoint: /v1/supervisor
    env_file: configs/supervisor_agent.env
    mega_flow:
      - supervisor